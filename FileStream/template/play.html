<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FileStreamBot | {{file_name}}</title>

<link rel="icon" href="https://i.ibb.co/Hh4kF2b/icon.png">

<link rel="stylesheet" href="https://unpkg.com/sheryjs/dist/Shery.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/proavipatil/data@main/fs/src/style.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/proavipatil/data@main/fs/src/plyr.css">
<script src="https://cdn.tailwindcss.com"></script>

<!-- ✅ FIX VISIBILITY + CENTER ICON/TEXT + SIZE -->
<style>
.downloadBtn,
.downloadBtn button {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    gap: 12px;
    width: 100%;
    max-width: 420px;
    margin: 0 auto;
}

.downloadBtn {
    flex-direction: column;
    margin-top: 18px;
}

.downloadBtn button {
    padding: 16px 20px;
    font-size: 17px;
    border-radius: 14px;
}

.downloadBtn img {
    height: 30px;
    width: 30px;
}
</style>
</head>

<body>

<div class="outer">
<div class="inner">

<div class="main" id="main">
    <!-- WEB PLAYER -->
    <video id="player" class="player" src="{{file_url}}" playsinline controls width="100%"></video>

    <div class="file-name">
        <b>File Name:</b> {{file_name}} <br>
        <b>File Size:</b> {{file_size}}
    </div>

    <!-- BUTTONS -->
    <div class="downloadBtn">

        <button onclick="copyLink()">
            <img src="https://i.ibb.co/CM4Y586/link.png">
            COPY LINK
        </button>

        <button onclick="openMX()">
            <img src="https://i.ibb.co/41WvtQ3/mx.png">
            MX PLAYER
        </button>

        <button onclick="openVLC()">
            <img src="https://i.ibb.co/px6fQs1/vlc.png">
            VLC PLAYER
        </button>

    </div>
</div>

</div>
</div>

<footer class="p-4 text-center text-sm text-gray-400">
    © 2025 Goflix. All Rights Reserved
</footer>

<script src="https://cdn.plyr.io/3.6.9/plyr.js"></script>

<script>
new Plyr('#player');

const FILE_ID = "{{file_id}}";
const BASE = window.location.origin;

// ✅ URL ENCODE FIX (THIS STOPS 404)
const STREAM_URL = `${BASE}/dl/${encodeURIComponent(FILE_ID)}`;

// COPY LINK
function copyLink() {
    navigator.clipboard.writeText(`${BASE}/watch/${encodeURIComponent(FILE_ID)}`);
    alert("Link copied");
}

// MX PLAYER (FASTEST + RELIABLE)
function openMX() {
    window.location.href = STREAM_URL;
}

// VLC PLAYER (SCHEME + FALLBACK)
function openVLC() {
    window.location.href = `vlc://${STREAM_URL}`;
    setTimeout(() => {
        window.location.href = STREAM_URL;
    }, 1000);
}
</script>

</body>
</html>
